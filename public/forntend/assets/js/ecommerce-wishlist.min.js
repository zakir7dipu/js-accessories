!function(e){e.ajaxSetup({headers:{"X-CSRF-TOKEN":e('meta[name="csrf-token"]').attr("content")}});const t=document.querySelectorAll(".myWish");let a=document.querySelector(".myWishesList"),l=document.querySelector(".wishListViewTable"),n=document.querySelector(".wishToCartBtn");const r=t=>{let a=l.querySelector("tbody");a.innerHTML="",Array.from(t).map((e,t)=>{let l=document.createElement("tr");l.className=`product-row wishListSet${e.id}`;let n=document.createElement("td");n.className="product-col";let r=document.createElement("figure");r.className="product-image-container";let c=document.createElement("a");c.href=window.location.protocol+"//"+window.location.host+"/single-product/"+e.slug,c.className="product-image";let s=document.createElement("img");s.src=e.image,s.alt="product",c.appendChild(s),r.appendChild(c);let i=document.createElement("h2");i.className="product-title";let o=document.createElement("a");o.href=window.location.protocol+"//"+window.location.host+"/single-product/"+e.slug,o.innerText=e.name,i.appendChild(o),n.appendChild(r),n.appendChild(i);let d=document.createElement("td");d.innerText=e.currence+e.price,l.appendChild(n),l.appendChild(d);let m=document.createElement("tr");m.className=`product-action-row wishListSet${e.id}`;let p=document.createElement("td");p.className="clearfix",p.colspan="2";let u=document.createElement("div");u.className="float-left";let h=document.createElement("a");h.className="btn-move",h.href="javascript:void(0)",h.innerText="Move to Cart",u.appendChild(h);let g=document.createElement("div");g.className="float-right";let w=document.createElement("a");w.title="Remove product",w.className="btn-remove listRowDelete",w.href="javascript:void(0)";let f=document.createElement("span");f.className="sr-only",f.innerText="Remove",w.appendChild(f),g.appendChild(w),p.appendChild(u),p.appendChild(g),m.appendChild(p),a.appendChild(l),a.appendChild(m)}),e(".listRowDelete").on("click",function(){let t=e(this).parent().parent().parent().attr("class");e(`.${t.split(" ")[1]}`).remove(),o(t.replace("product-action-row wishListSet",""))})},c=t=>{e(".wishCount").html(t)},s=t=>{a.innerHTML="",Array.from(t).map((e,t)=>{let l=document.createElement("div");l.className=`product wishListSet${e.id}`,l.setAttribute("datasrc",e.id);let n=document.createElement("div");n.className="product-details";let r=document.createElement("h4");r.className="product-title",r.innerText=e.name;let c=document.createElement("span");c.className="cart-product-info",c.innerText=e.currence+(e.price-e.discount),n.appendChild(r),n.appendChild(c);let s=document.createElement("figure");s.className="product-image-container";let i=document.createElement("a");i.href="javascript:void(0)",i.className="product-image";let o=document.createElement("img");o.src=e.image,o.alt="product",i.appendChild(o);let d=document.createElement("a");d.className="btn-remove wishRemove",d.title="Remove Product";let m=document.createElement("i");m.className="icon-retweet",d.appendChild(m),s.appendChild(i),s.appendChild(d),l.appendChild(n),l.appendChild(s),a.appendChild(l)}),e(".wishRemove").on("click",function(){o(e(this).parent().parent().attr("datasrc")),e(this).parent().parent().remove()}),"/my-wishes"===window.location.pathname&&r(t)},i=()=>localStorage.getItem("wishlist"),o=e=>{let t=JSON.parse(i());t.length<2&&localStorage.removeItem("wishlist"),Array.from(t).map((a,l)=>{a.id===parseInt(e)&&(t.splice(l,1),c(t.length),s(t),localStorage.setItem("wishlist",JSON.stringify(t)))})};Array.from(t).map((t,a)=>{t.addEventListener("click",t=>{let a=t.target.parentElement;"product-action"===a.className&&(a=a.querySelector(".myWish"));let l=a.getAttribute("data-role");e.ajax({type:"get",url:`/product-info/${l}`,success:function(e){(e=>{let t=JSON.parse(i())?JSON.parse(i()):[],a="";Array.from(t).map((t,l)=>{t.id==e.id&&(a=l)}),t.length>=4?toastr.warning("You have already 5 item on wish list. Please may you process those at first."):("number"==typeof a?(t[a]=e,toastr.success("Wishlist has been updated.")):(t.push(e),toastr.success("A Product has been added with Wishlist.")),0===t.length&&(t.push(e),toastr.success("A Product has been added with Wishlist.")),c(t.length),s(t),localStorage.setItem("wishlist",JSON.stringify(t)),setTimeout(()=>{location.reload()},1e3))})({id:e.id,name:e.name,image:e.image,currence:e.currence,discount:e.discount,price:e.price,wish_date:e.wish_date,slug:e.slug})}})})});let d=JSON.parse(i())?JSON.parse(i()):[];n.addEventListener("click",t=>{t.preventDefault();let a=[];Array.from(d).map((e,t)=>{a.push(e.id)}),a.length>0&&e.ajax({type:"post",url:"/my-cart/set",data:{products:a},success:function(e){"success"===e.status&&localStorage.removeItem("wishlist"),toastr[e.status](e.message),setTimeout(()=>{location.reload()},1e3)}})}),c(d.length),s(d)}(jQuery);
